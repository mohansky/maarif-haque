---
// src/pages/blog/[...slug].astro
import { Image } from "astro:assets";
import Heading from "../../components/Heading.astro";
import { getCollection, getEntry, render } from "astro:content";
import BlogLayout from "../../layouts/BlogLayout.astro"; 
import { components } from "../../components/CustomUI";

export async function getStaticPaths() {
  const projectEntries = await getCollection("projects");
  return projectEntries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry: propsEntry } = Astro.props;
const entry = await getEntry("projects", propsEntry.id);
if (!entry) {
  throw new Error("Could not find blog post with id: " + propsEntry.id);
}
const { Content } = await render(entry);
---

<BlogLayout>
  <article class="my-20">
    <div class="flex flex-col items-center justify-center py-10">
      {
        entry.data.icon && (
          <div class="my-10 flex flex-col items-center gap-1">
            <Image
              src={entry.data.icon}
              alt={entry.data.iconTitle || entry.data.title}
              width={61}
              height={61}
              class="w-24 h-24"
            />
            <figcaption class="font-bold">{entry.data.iconTitle}</figcaption>
          </div>
        )
      }
      <Heading as="h1" class="mb-5">{entry.data.title}</Heading>

      {
        entry.data.tags && (
          <div class="flex flex-wrap gap-2 mt-8 items-center justify-center">
            {entry.data.tags.map((tag, index) => (
              <>
                <p class="text-sm uppercase text-base-content/70">{tag}</p>
                {index < entry.data.tags.length - 1 && (
                  <span class="text-base-content/80">â€¢</span>
                )}
              </>
            ))}
          </div>
        )
      }

      <p class="max-w-lg text-center font-brawler font-bold text-balance text-xl text-base-content my-6 tracking-widest">
        {entry.data.description}
      </p>
      {
        entry.data.image && (
          <div class="max-w-3xl h-auto overflow-hidden my-10">
            <Image
              src={entry.data.image}
              alt={entry.data.imageAlt || entry.data.title}
              width={1172}
              height={548}
              class="w-full h-full object-cover"
            />
            <figcaption class="text-center italic text-sm text-gray-600 mt-2">
              {entry.data.imageAlt}
            </figcaption>
          </div>
        )
      }
    </div>

    <div class=" ">
      <!-- <Content components={{ Container, Columns, OrderedList, UnorderedList, StyledHeading }} /> -->
      <Content components={components} />
    </div>

    <div class="mt-20 mx-auto  w-full lg:max-w-3xl py-10 px-8 bg-base-300 rounded-md">
      <h5 class="text-xl font-bold mb-3">Want to see the case study?</h5>
      <a
        href="/"
        class="inline-flex items-center text-blue-600 hover:text-blue-800 font-bold"
      >
        Get in touch
      </a>
      for a deep-dive.
    </div>
  </article>
</BlogLayout>
